---
doc_type: "security_doc"
id: "threat-model"
version: "1.0"
last_updated: "2026-01-25"
status: "draft"
---

# 脅威モデル

本ドキュメントは、予約・決済基盤システムに対する脅威モデルを定義します。

---

## 1. 概要

### 1.1 目的

- システムに対する潜在的な脅威を体系的に特定する
- リスクを評価し、適切な対策を講じる
- セキュリティ設計の根拠を文書化する

### 1.2 対象範囲

| 項目 | 対象 |
|------|------|
| システム | 予約・決済基盤（Booking Payment Platform） |
| Bounded Contexts | IAM、Booking、Payment、Notification、Audit |
| インフラ | AWS（ECS/EKS、RDS、ElastiCache、SQS/Kafka） |
| 外部連携 | 決済ゲートウェイ、通知サービス |

### 1.3 脅威モデリング手法

本ドキュメントでは **STRIDE** モデルを採用します。

| 脅威カテゴリ | 説明 | 対象となる性質 |
|-------------|------|---------------|
| **S**poofing（なりすまし） | 他者になりすます | 認証 |
| **T**ampering（改ざん） | データを不正に変更する | 完全性 |
| **R**epudiation（否認） | 行為を否認する | 否認防止 |
| **I**nformation Disclosure（情報漏洩） | 機密情報が漏洩する | 機密性 |
| **D**enial of Service（サービス拒否） | サービスを利用不能にする | 可用性 |
| **E**levation of Privilege（権限昇格） | 不正に権限を取得する | 認可 |

---

## 2. 資産の特定

### 2.1 データ資産

#### 2.1.1 機密性レベル定義

| レベル | 名称 | 説明 | 例 |
|--------|------|------|-----|
| **L4** | 最高機密 | 漏洩時に重大な法的・金銭的影響 | 決済カード情報、パスワードハッシュ |
| **L3** | 機密 | 漏洩時にビジネス影響大 | 個人情報（PII）、APIキー |
| **L2** | 社内限定 | 内部利用のみ許可 | 予約詳細、監査ログ |
| **L1** | 公開 | 公開可能 | 公開API仕様、ドキュメント |

#### 2.1.2 データ資産一覧

| 資産ID | 資産名 | 説明 | 機密性 | 保管場所 | 責任BC |
|--------|--------|------|--------|----------|--------|
| DA-001 | ユーザー認証情報 | メールアドレス、パスワードハッシュ | L4 | PostgreSQL (users) | IAM |
| DA-002 | アクセストークン | JWT形式のアクセストークン | L3 | クライアント、メモリ | IAM |
| DA-003 | リフレッシュトークン | JWT形式のリフレッシュトークン | L4 | PostgreSQL (refresh_tokens) | IAM |
| DA-004 | 予約データ | 予約詳細、ユーザーID、リソースID | L2 | PostgreSQL (bookings) | Booking |
| DA-005 | 決済情報 | 決済ID、金額、ステータス | L3 | PostgreSQL (payments) | Payment |
| DA-006 | 決済カード情報 | カード番号、CVV | L4 | 外部Gateway（非保持） | Payment |
| DA-007 | 冪等キー記録 | 冪等キーと処理結果 | L2 | PostgreSQL (idempotency_records) | Payment |
| DA-008 | 通知内容 | 通知メッセージ、宛先 | L2 | PostgreSQL (notifications) | Notification |
| DA-009 | 監査ログ | 全操作の記録 | L2 | PostgreSQL (audit_logs) | Audit |
| DA-010 | APIシークレット | JWT署名鍵、DB認証情報、外部APIキー | L4 | AWS Secrets Manager | 横断 |

### 2.2 システム資産

#### 2.2.1 コンポーネント一覧

| 資産ID | コンポーネント | 説明 | 可用性要件 |
|--------|---------------|------|-----------|
| SA-001 | API Gateway | 外部トラフィックの入口 | 99.9% |
| SA-002 | IAM Service | 認証・認可処理 | 99.9% |
| SA-003 | Booking Service | 予約管理 | 99.5% |
| SA-004 | Payment Service | 決済処理 | 99.9% |
| SA-005 | Notification Service | 通知配信 | 99.0% |
| SA-006 | Audit Service | 監査ログ記録 | 99.5% |
| SA-007 | PostgreSQL | プライマリデータストア | 99.9% |
| SA-008 | Redis | キャッシュ、Rate Limiting | 99.5% |
| SA-009 | Message Queue | 非同期メッセージング | 99.9% |

#### 2.2.2 外部連携

| 資産ID | 連携先 | 目的 | 信頼レベル |
|--------|--------|------|-----------|
| EA-001 | 決済ゲートウェイ | 決済処理 | 高（契約・SLA） |
| EA-002 | メール配信サービス | メール通知 | 中（契約） |
| EA-003 | プッシュ通知サービス | プッシュ通知 | 中（契約） |
| EA-004 | SMS配信サービス | SMS通知 | 中（契約） |

### 2.3 ユーザー・アクター

| アクターID | アクター | 説明 | 信頼レベル |
|-----------|---------|------|-----------|
| AC-001 | 一般ユーザー | サービス利用者 | 低（認証必要） |
| AC-002 | 管理者 | システム管理者 | 高（追加認証） |
| AC-003 | 内部サービス | サービス間通信 | 高（mTLS） |
| AC-004 | 外部サービス | Webhook等 | 中（署名検証） |
| AC-005 | 匿名ユーザー | 未認証ユーザー | 最低 |

---

## 3. STRIDE分析

### 3.1 認証・認可（IAM）

#### 3.1.1 Spoofing（なりすまし）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-IAM-S01 | クレデンシャルスタッフィング | 漏洩したパスワードリストで大量ログイン試行 | 高 | 高 |
| T-IAM-S02 | セッションハイジャック | 盗んだトークンでユーザーになりすます | 高 | 中 |
| T-IAM-S03 | フィッシング | 偽サイトでクレデンシャルを窃取 | 高 | 中 |
| T-IAM-S04 | JWTトークン偽造 | 秘密鍵漏洩時にトークンを偽造 | 致命的 | 低 |

#### 3.1.2 Tampering（改ざん）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-IAM-T01 | JWT改ざん | トークンのペイロードを改ざん | 高 | 低 |
| T-IAM-T02 | パスワードリセット操作 | 不正なパスワードリセットリクエスト | 中 | 中 |

#### 3.1.3 Repudiation（否認）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-IAM-R01 | ログイン操作の否認 | 不正ログインを「自分ではない」と主張 | 中 | 中 |

#### 3.1.4 Information Disclosure（情報漏洩）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-IAM-I01 | ユーザー情報漏洩 | SQLインジェクションでユーザーテーブル窃取 | 致命的 | 低 |
| T-IAM-I02 | トークン漏洩 | ログ/エラーメッセージにトークン出力 | 高 | 中 |
| T-IAM-I03 | ユーザー列挙 | ログインエラーメッセージでユーザー存在確認 | 低 | 高 |

#### 3.1.5 Denial of Service（サービス拒否）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-IAM-D01 | ブルートフォース攻撃 | 大量のログイン試行でサービス負荷 | 中 | 高 |
| T-IAM-D02 | アカウントロックアウト攻撃 | 他者アカウントを意図的にロック | 中 | 中 |

#### 3.1.6 Elevation of Privilege（権限昇格）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-IAM-E01 | 管理者権限取得 | 脆弱性を利用して管理者ロールを取得 | 致命的 | 低 |
| T-IAM-E02 | JWT権限改ざん | JWTのロール情報を改ざん | 高 | 低 |

### 3.2 予約管理（Booking）

#### 3.2.1 Spoofing（なりすまし）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-BK-S01 | 他者予約の操作 | 認可バイパスで他ユーザーの予約を変更 | 高 | 低 |

#### 3.2.2 Tampering（改ざん）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-BK-T01 | 予約時間改ざん | リクエスト改ざんで過去日時の予約作成 | 中 | 中 |
| T-BK-T02 | バージョン改ざん | 楽観的ロックのバージョン値を改ざん | 中 | 低 |

#### 3.2.3 Repudiation（否認）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-BK-R01 | 予約操作の否認 | 予約・キャンセル操作を「自分ではない」と主張 | 中 | 中 |

#### 3.2.4 Information Disclosure（情報漏洩）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-BK-I01 | 他者予約情報閲覧 | IDOR脆弱性で他ユーザーの予約詳細取得 | 中 | 中 |

#### 3.2.5 Denial of Service（サービス拒否）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-BK-D01 | 予約枠独占 | 大量の予約作成でリソースを独占 | 中 | 中 |
| T-BK-D02 | 衝突検出の負荷攻撃 | 大量の重複予約リクエストでDB負荷 | 中 | 中 |

### 3.3 決済処理（Payment）

#### 3.3.1 Spoofing（なりすまし）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-PAY-S01 | 不正な支払い要求 | 他者の予約に対して支払い実行 | 高 | 低 |
| T-PAY-S02 | Webhook偽装 | 決済Gatewayからの通知を偽装 | 高 | 中 |

#### 3.3.2 Tampering（改ざん）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-PAY-T01 | 金額改ざん | リクエストの金額を改ざんして低額で支払い | 致命的 | 中 |
| T-PAY-T02 | 冪等キー再利用 | 過去の冪等キーで不正なリプレイ | 中 | 低 |

#### 3.3.3 Repudiation（否認）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-PAY-R01 | 支払い操作の否認 | 「支払いを実行していない」と主張 | 高 | 中 |
| T-PAY-R02 | 返金要求の濫用 | 不当な返金要求を繰り返す | 中 | 中 |

#### 3.3.4 Information Disclosure（情報漏洩）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-PAY-I01 | 決済情報漏洩 | ログに決済トークンが出力 | 高 | 低 |
| T-PAY-I02 | カード情報漏洩 | カード情報をログ/DBに保存 | 致命的 | 低 |

#### 3.3.5 Denial of Service（サービス拒否）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-PAY-D01 | 決済Gateway過負荷 | 大量の決済リクエストでGateway制限到達 | 高 | 中 |

#### 3.3.6 Elevation of Privilege（権限昇格）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-PAY-E01 | 無料サービス利用 | 支払いステータスを改ざんして無料利用 | 高 | 低 |

### 3.4 通知（Notification）

#### 3.4.1 Information Disclosure（情報漏洩）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-NTF-I01 | 通知内容漏洩 | 他者の通知履歴を閲覧 | 中 | 低 |
| T-NTF-I02 | 宛先情報漏洩 | メールアドレス・電話番号の漏洩 | 高 | 低 |

#### 3.4.2 Denial of Service（サービス拒否）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-NTF-D01 | 通知スパム | 大量の通知トリガーで配信サービス制限 | 中 | 中 |

### 3.5 監査（Audit）

#### 3.5.1 Tampering（改ざん）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-AUD-T01 | 監査ログ改ざん | 不正操作の証拠を消去・改ざん | 致命的 | 低 |

#### 3.5.2 Repudiation（否認）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-AUD-R01 | 操作の否認 | 監査ログが不十分で操作を証明できない | 高 | 低 |

#### 3.5.3 Information Disclosure（情報漏洩）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-AUD-I01 | 監査ログからのPII漏洩 | 監査ログにPIIが含まれて漏洩 | 高 | 中 |

### 3.6 インフラ・横断

#### 3.6.1 Information Disclosure（情報漏洩）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-INF-I01 | シークレット漏洩 | Git履歴、ログ、エラーメッセージにシークレット | 致命的 | 中 |
| T-INF-I02 | DB不正アクセス | ネットワーク経由でDBに直接アクセス | 致命的 | 低 |

#### 3.6.2 Denial of Service（サービス拒否）

| 脅威ID | 脅威 | 攻撃シナリオ | 影響度 | 発生可能性 |
|--------|------|-------------|--------|-----------|
| T-INF-D01 | DDoS攻撃 | 大量トラフィックでサービス停止 | 高 | 高 |
| T-INF-D02 | リソース枯渇 | メモリ/ディスク/接続数の枯渇 | 高 | 中 |

---

## 4. 対策とリスク評価

### 4.1 リスク評価マトリクス

| 発生可能性 \ 影響度 | 低 | 中 | 高 | 致命的 |
|--------------------|-----|-----|-----|--------|
| **高** | 中 | 高 | 致命的 | 致命的 |
| **中** | 低 | 中 | 高 | 致命的 |
| **低** | 許容 | 低 | 中 | 高 |

### 4.2 対策一覧

#### 4.2.1 認証・認可（IAM）

| 脅威ID | 対策 | 実装状態 | 残留リスク |
|--------|------|---------|-----------|
| T-IAM-S01 | Rate Limiting（5回/分）、アカウントロック（10回失敗で30分） | 設計済み | 低 |
| T-IAM-S02 | 短期トークン（15分）、Secure/HttpOnly Cookie、トークンローテーション | 設計済み | 低 |
| T-IAM-S03 | ユーザー教育、フィッシング検知（スコープ外） | N/A | 中（受容） |
| T-IAM-S04 | 鍵の厳格な管理、Secrets Manager、漏洩検知・即時ローテーション | 設計済み | 低 |
| T-IAM-T01 | RS256署名、署名検証 | 設計済み | 低 |
| T-IAM-T02 | メール検証、Rate Limiting | 設計済み | 低 |
| T-IAM-R01 | 監査ログ（IPアドレス、User-Agent記録） | 設計済み | 低 |
| T-IAM-I01 | パラメタライズドクエリ、ORM使用 | 設計済み | 低 |
| T-IAM-I02 | PIIマスキング、ログレビュー | 設計済み | 低 |
| T-IAM-I03 | 統一エラーメッセージ（「認証に失敗しました」） | 設計済み | 低 |
| T-IAM-D01 | Rate Limiting、WAF | 設計済み | 低 |
| T-IAM-D02 | CAPTCHA、段階的ロック | 設計済み | 低 |
| T-IAM-E01 | 最小権限原則、定期的な権限レビュー | 設計済み | 低 |
| T-IAM-E02 | サーバーサイドでの権限検証、JWTクレームの署名検証 | 設計済み | 低 |

#### 4.2.2 予約管理（Booking）

| 脅威ID | 対策 | 実装状態 | 残留リスク |
|--------|------|---------|-----------|
| T-BK-S01 | 所有者検証（user_id == token.sub）、認可ミドルウェア | 設計済み | 低 |
| T-BK-T01 | サーバーサイドでの日時検証、過去日時拒否 | 設計済み | 低 |
| T-BK-T02 | 楽観的ロックの厳格な検証、不正値は409 Conflict | 設計済み | 低 |
| T-BK-R01 | 監査ログ（全操作記録）、タイムスタンプ | 設計済み | 低 |
| T-BK-I01 | 所有者検証、API応答のフィルタリング | 設計済み | 低 |
| T-BK-D01 | ユーザー別予約上限、Rate Limiting | 設計済み | 低 |
| T-BK-D02 | クエリ最適化、インデックス、コネクションプール | 設計済み | 低 |

#### 4.2.3 決済処理（Payment）

| 脅威ID | 対策 | 実装状態 | 残留リスク |
|--------|------|---------|-----------|
| T-PAY-S01 | 予約所有者と支払い要求者の一致検証 | 設計済み | 低 |
| T-PAY-S02 | Webhook署名検証（HMAC）、送信元IP制限 | 設計済み | 低 |
| T-PAY-T01 | サーバーサイドでの金額計算、予約との照合 | 設計済み | 低 |
| T-PAY-T02 | 冪等キーの有効期限、使用済みキーの検出 | 設計済み | 低 |
| T-PAY-R01 | 監査ログ、決済Gatewayの記録、トランザクションID | 設計済み | 低 |
| T-PAY-R02 | 返金ポリシーの明確化、管理者承認フロー | 設計済み | 低 |
| T-PAY-I01 | トークンのマスキング、ログへの非出力 | 設計済み | 低 |
| T-PAY-I02 | PCI DSS準拠、カード情報非保持（トークン化） | 設計済み | 低 |
| T-PAY-D01 | Rate Limiting、Circuit Breaker、リトライ戦略 | 設計済み | 低 |
| T-PAY-E01 | ステータス遷移の厳格な検証、サーバーサイドでの状態管理 | 設計済み | 低 |

#### 4.2.4 通知（Notification）

| 脅威ID | 対策 | 実装状態 | 残留リスク |
|--------|------|---------|-----------|
| T-NTF-I01 | 所有者検証、API認可 | 設計済み | 低 |
| T-NTF-I02 | PIIマスキング、暗号化保存 | 設計済み | 低 |
| T-NTF-D01 | ユーザー別通知Rate Limiting、キューイング | 設計済み | 低 |

#### 4.2.5 監査（Audit）

| 脅威ID | 対策 | 実装状態 | 残留リスク |
|--------|------|---------|-----------|
| T-AUD-T01 | 追記専用テーブル、DBトリガーで更新/削除禁止、チェックサム | 設計済み | 低 |
| T-AUD-R01 | 必須フィールドの強制、全操作の自動記録 | 設計済み | 低 |
| T-AUD-I01 | PIIマスキング、アクセス制御（管理者のみ） | 設計済み | 低 |

#### 4.2.6 インフラ・横断

| 脅威ID | 対策 | 実装状態 | 残留リスク |
|--------|------|---------|-----------|
| T-INF-I01 | git-secrets、Gitleaks、Secrets Manager、漏洩対応手順 | 設計済み | 低 |
| T-INF-I02 | VPC、Security Group、DB認証、暗号化通信 | 設計済み | 低 |
| T-INF-D01 | CloudFront/WAF、Auto Scaling、Rate Limiting | 設計済み | 中（コスト考慮） |
| T-INF-D02 | リソースモニタリング、アラート、Auto Scaling | 設計済み | 低 |

### 4.3 残留リスクサマリー

| リスクレベル | 脅威数 | 主な脅威 | 対応方針 |
|-------------|--------|---------|---------|
| **致命的** | 0 | - | - |
| **高** | 0 | - | - |
| **中** | 2 | T-IAM-S03（フィッシング）、T-INF-D01（DDoS） | リスク受容（追加対策はコスト対効果を検討） |
| **低** | 残り全て | - | 監視継続 |

---

## 5. 脅威と対策の対応図

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           Trust Boundaries                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│   ┌──────────────┐          [TLS]           ┌──────────────┐                │
│   │   Browser/   │ ◄──────────────────────► │  API Gateway │                │
│   │   Client     │         [WAF]            │  (SA-001)    │                │
│   └──────────────┘      Rate Limiting       └──────┬───────┘                │
│         │                                          │                         │
│         │ T-IAM-S01,S02,S03                        │ JWT Validation          │
│         │ T-INF-D01                                │                         │
│         ▼                                          ▼                         │
│   ┌─────────────────────────────────────────────────────────────┐           │
│   │                    Internal Network (VPC)                     │           │
│   │  ┌─────────────────────────────────────────────────────────┐ │           │
│   │  │                   Service Mesh / mTLS                    │ │           │
│   │  │                                                          │ │           │
│   │  │   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐│ │           │
│   │  │   │   IAM   │   │ Booking │   │ Payment │   │  Notif  ││ │           │
│   │  │   │ (SA-002)│   │(SA-003) │   │(SA-004) │   │(SA-005) ││ │           │
│   │  │   └────┬────┘   └────┬────┘   └────┬────┘   └────┬────┘│ │           │
│   │  │        │             │             │             │      │ │           │
│   │  │   T-IAM-*       T-BK-*        T-PAY-*       T-NTF-*    │ │           │
│   │  │        │             │             │             │      │ │           │
│   │  │        └──────────┬──┴──────────┬──┴─────────────┘      │ │           │
│   │  │                   ▼             ▼                       │ │           │
│   │  │              ┌─────────┐   ┌─────────┐                  │ │           │
│   │  │              │  Audit  │   │  Queue  │                  │ │           │
│   │  │              │(SA-006) │   │(SA-009) │                  │ │           │
│   │  │              └────┬────┘   └─────────┘                  │ │           │
│   │  │                   │                                     │ │           │
│   │  │              T-AUD-*                                    │ │           │
│   │  └─────────────────────────────────────────────────────────┘ │           │
│   │                           │                                   │           │
│   │  ┌─────────────────────────────────────────────────────────┐ │           │
│   │  │                  Data Layer (Encrypted)                  │ │           │
│   │  │                                                          │ │           │
│   │  │   ┌──────────────┐    ┌──────────────┐                  │ │           │
│   │  │   │  PostgreSQL  │    │    Redis     │                  │ │           │
│   │  │   │   (SA-007)   │    │   (SA-008)   │                  │ │           │
│   │  │   └──────────────┘    └──────────────┘                  │ │           │
│   │  │         │                                                │ │           │
│   │  │    T-INF-I02                                            │ │           │
│   │  └─────────────────────────────────────────────────────────┘ │           │
│   └─────────────────────────────────────────────────────────────┘           │
│                                                                              │
│   ┌──────────────────────────────────────────────────────────────┐          │
│   │              External Services (Third Party)                  │          │
│   │                                                               │          │
│   │   ┌───────────────┐   ┌───────────────┐   ┌───────────────┐ │          │
│   │   │    Payment    │   │     Email     │   │     Push      │ │          │
│   │   │    Gateway    │   │    Service    │   │    Service    │ │          │
│   │   │   (EA-001)    │   │   (EA-002)    │   │   (EA-003)    │ │          │
│   │   └───────────────┘   └───────────────┘   └───────────────┘ │          │
│   │         │                                                    │          │
│   │    T-PAY-S02 (Webhook)                                      │          │
│   └──────────────────────────────────────────────────────────────┘          │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 6. レビューと更新

### 6.1 レビュースケジュール

| 頻度 | 内容 | 担当 |
|------|------|------|
| 四半期 | 脅威モデル全体のレビュー | セキュリティチーム |
| 機能追加時 | 新機能に対する脅威分析 | 開発チーム + セキュリティ |
| インシデント後 | 脅威モデルの見直し | インシデント対応チーム |
| 年次 | 外部ペネトレーションテスト | 外部ベンダー |

### 6.2 更新履歴

| バージョン | 日付 | 変更内容 | 担当者 |
|-----------|------|---------|--------|
| 1.0 | 2026-01-25 | 初版作成 | - |

---

## 7. 関連ドキュメント

| ドキュメント | 内容 |
|--------------|------|
| `docs/security/secrets.md` | シークレット管理、漏洩対応手順 |
| `docs/security/pii-policy.md` | PII保護ポリシー |
| `docs/design/security.md` | セキュリティ設計 |
| `docs/design/observability.md` | 観測性設計（セキュリティ監視含む） |
| `docs/design/contexts/*.md` | 各コンテキストの設計 |

---

## 8. Evidence（根拠）

| 項目 | 根拠 | 備考 |
|------|------|------|
| STRIDEモデル | Microsoft SDL | 業界標準の脅威モデリング手法 |
| リスク評価マトリクス | NIST SP 800-30 | リスクアセスメントガイド |
| 対策設計 | OWASP ASVS 4.0 | アプリケーションセキュリティ検証標準 |
| PCI DSS準拠 | PCI DSS v4.0 | 決済カード業界データセキュリティ基準 |
